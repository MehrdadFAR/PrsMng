import pandas as pd
from datetime import datetime, time
import numpy as np

# Importing data
data = pd.read_csv('BPI Challenge 2017-training.csv', encoding = 'cp1252')

# Converting String to datetime
timestamp = data.columns.get_loc("event time:timestamp")
data[data.columns[timestamp]] = pd.to_datetime(data[data.columns[timestamp]], format='%d-%m-%Y %H:%M:%S.%f')

# Grouping cases by start and end time
start_end_log = data.groupby('case concept:name')['event time:timestamp'].apply(list)

# Computing the delta
delta = []

for i in start_end_log:
    first = i[0]
    last = i[-1]
    delta = last-first
    
# Naive estimator ouput
Estimation = np.mean(delta)
